_base_: ./ast2_ucf101.yaml
training:
  mode: version_c_full
  outer_epochs: 2
  inner_steps_ast: 2
  inner_steps_alpha: 1
  inner_steps_layout: 1
hw:
  mode: version_c_full
  use_fine_split: true
  optimize_layout: true
stable_hw:
  enabled: true
  warmup_epochs: 1
  locked_acc_ref: true
  allow_train_ema_fallback: true
  lambda_hw_schedule:
    enabled: true
    warmup_epochs: 0
    ramp_epochs: 1
    lambda_hw_max: 0.2
    clamp_min: 0.0
    clamp_max: 0.2
  normalize:
    mode: hinge_log_ratio
    eps: 1.0e-6
    wT: 0.4
    wE: 0.2
    wM: 0.2
    wC: 0.2
    target_ratio_T: 0.9
    target_ratio_E: 0.9
    mem_hinge_only: true
    clip_term_max: 10.0
  accuracy_guard:
    enabled: true
    metric: acc1
    epsilon_drop: 0.01
    use_ema: true
    ema_beta: 0.9
    on_violate:
      mode: "RECOVERY"
      scale_lambda_hw: 0.0
      recovery_epochs: 1
      freeze_discrete_updates: true
      min_recovery_epochs: 1
  discrete_isolation:
    mapping_update_every_epochs: 1
    layout_update_every_epochs: 1
    use_cached_mapping_for_inner_steps: true
    use_cached_layout_for_inner_steps: true
    track_live_in_inner_steps: false
