# A0: Window-only (HW off, Token off, Window on)
# Purpose: quantify the contribution of window retention itself (cost/speed/accuracy).
_base_: configs/ast2_ucf101_dense.yaml

model:
  use_ast_prune: false

data:
  clip_lens_train: [16]
  clip_lens_eval: [16]

  # Keep stride aligned with A1 so window remains the main difference,
  # but use higher-accuracy stride (moderate extra cost on 3x4090).
  train_stride_ratio: 0.75
  eval_stride_ratio: 0.75

  # Align window budget with A4 (Version-C full) to avoid confounding variables
  window_retention:
    enabled: true
    # Increase train coverage so A0 does not under-train vs A1, while still keeping a bounded window budget.
    max_windows_per_video_per_len_train: 24
    # Eval uses uniform sampling (deterministic) and can be slightly denser for accuracy stability.
    max_windows_per_video_per_len_eval: 24
    # Candidate pool for entropy-density selection (train). Larger = better coverage but more preprocessing cost.
    eval_candidates: 256
    # Ensure deterministic eval behavior (avoid inheriting base eval_mode=entropy_density).
    eval_mode: "uniform"
    # Encourage diversity among selected windows.
    min_gap: 8
    # Slightly weaker distance decay to avoid collapsing around the anchor window.
    lambda_dist: 0.25

test:
  run_final_test: true

# Regularization to reduce train/test gap (no pretrain)
train:
  mixup_alpha: 0.2
  mixup_prob: 1.0
  mixup_switch_off_epoch: 18
  label_smoothing: 0.1
  ema: true
  ema_decay: 0.9999
